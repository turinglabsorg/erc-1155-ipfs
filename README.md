# ERC-1155 with IPFS support

This repository is needed when you want to deploy an ERC-1155 smart contract and want to use IPFS as metadata storage.
Of course you may know that officially is IPFS is not supported by OpenSea, because metadata are fetched using this pattern `https://bridgedomain.xyz/nft/{id}.json`.
Metadata are served by a centralized API, so we prepared an api which fetches the metadata CID from the contract, downloads the metadata from IPFS and serves them for Opensea.

You'll find two different folders, one is for the smart contract and one is for the api. For both projects you'll need NodeJS an YARN, please be sure to download all dependencies first.

## Deploy the smart contract

To compile and deploy the smart contract you first need to create a configuration file by copying `configs/example.json` file.
Then install the dependencies with following command:
```
yarn
```

Now let's say you want to compile to ganache, so create the file `configs/ganache.json` with following properties:
```
{
    "network": "ganache",
    "contract_address": "THIS_FIELD_WILL_BE_AUTOMATICALLY_FIELD",
    "owner_mnemonic": "OWNER_MNEMONIC",
    "owner_address": "OWNER_ADDRESS",
    "provider": "http://localhost:7545"
}
```

When you've completed the configuration you can use following command to compile the contract:

```npm run deploy ganache```

If everything is correct you will see the `contract_address` parameter automatically filled by the deployer.

### Make tests

To run tests you can use what we've prepared for you buy one of following:

```
npm run test:prepare ganache
npm run test:mint ganache
npm run test:created ganache
```

## Use the API

The API is used to fetch data from the contract, by passing the token Id (which is auto-generated by the contract).
You need to install the dependencies again with following command:
```
yarn
```

Then you've to create a `.env` file, by copying the `.env.example` file. You have to define few parameters to connect the contract.

You can also upload files using [Pi√±ata](https://www.pinata.cloud/) by setting up following parameters into the `.env` file:
```
PINATA_KEY=YOUR_PINATA_KEY
PINATA_SECRET=YOUR_PINATA_SECRET
UPLOAD_KEY=A_SECURE_KEY_TO_PROTECT_AND_ACTIVATE_UPLOAD_ENDPOINT
```